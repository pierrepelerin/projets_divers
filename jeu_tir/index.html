<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="style.css">
	<title>Jeu de tir</title>
	<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet"> <!-- Police Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet"> <!-- Police Google Font -->
</head>
<body>

	<!-- ! ECRAN DE DEMARRAGE -->
	<div id="nouvellePartie">
		<h1>DEBUG THE CODE</h1>
		<p><b>Des cafards ont envahi le code et menacent de tout corrompre !</b><br><br>Ton objectif est simple : clique le plus vite possible pour les éliminer avant qu’ils ne disparaissent.<br>Chaque niveau devient plus rapide et plus difficile.<br><br>Pour passer au niveau suivant, tu dois atteindre au minimum 80 % de réussite.<br><br>Reste concentré, sois précis… et nettoie le code avant qu’il ne soit trop tard !</p>
		<button id="btnCommencer">Démarrer</button>
	</div>

	<!-- ! AFFICHAGE DES SCORES -->
	<div id="scores">
		<table id="tableauScores">
			<tr>
				<td colspan="2">Niveau : <span id="level">1</span></td> <!-- Affichage du niveau en cours -->
			</tr>
			<tr>
				<td>Cafards apparus : <span id="NbApparitions">0</span></td> <!-- Affichage du nombre de cafards apparus dans le niveau -->
				<td>Cafards explosés : <span id="NbExplosions">0</span></td> <!-- Affichage du nombre de cafards explosés dans le niveau -->
			</tr>
		</table>
	</div>

	<!-- ! ECRAN DE JEU -->
	<div id="sceneJeu" hidden>
 		<p>document.addEventListener("DOMContentLoaded", () => {  const scene = document.querySelector("#sceneJeu");  const scores = document.querySelector("#scores");  const nouvellePartie = document.querySelector("#nouvellePartie");  const btnStart = nouvellePartie.querySelector("button");  const elNbApp = document.querySelector("#NbApparitions");  const elNbExp = document.querySelector("#NbExplosions");  const overlay = document.querySelector("#overlay");  const panelText = document.querySelector("#panelText");  const btnContinue = document.querySelector("#btnContinue");  const spanLevel = document.querySelector("#level");  let NbApparition = 0;  let NbExplosions = 0;  let Niveau = 1;  function show(el) { el.hidden = false; }  function hide(el) { el.hidden = true; }  show(nouvellePartie);  hide(scene);  hide(scores);  overlay.classList.add("hidden");  elNbApp.textContent = "0";  elNbExp.textContent = "0";  spanLevel.textContent = "1";  function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }  function showPanel(message, showButton = true) { panelText.textContent = message; if (showButton) { btnContinue.style.display = "inline-block"; } else { btnContinue.style.display = "none"; } overlay.classList.remove("hidden"); }  function hidePanel() { overlay.classList.add("hidden"); }  function waitContinueClick() { return new Promise(resolve => { btnContinue.addEventListener("click", () => { hidePanel(); resolve(); }, { once: true }); }); }  function addTarget({ posX, posY }) { const target = { x: posX, y: posY, HTMLelement: null, isExploding: false, clickResolver: null, disappear() { if (this.HTMLelement) this.HTMLelement.style.display = "none"; }, render() { if (this.HTMLelement === null) { this.HTMLelement = document.createElement("div"); this.HTMLelement.className = "target"; scene.append(this.HTMLelement); this.HTMLelement.addEventListener("click", () => this.explode()); } this.HTMLelement.style.display = "block"; this.HTMLelement.style.position = "absolute"; this.HTMLelement.style.top = this.y + "px"; this.HTMLelement.style.left = this.x + "px"; this.HTMLelement.classList.remove("appear"); void this.HTMLelement.offsetWidth; this.HTMLelement.classList.add("appear"); }, randomPosition() { const sceneW = scene.clientWidth; const sceneH = scene.clientHeight; const cafardW = 60; const cafardH = 60; const margin = 10; const maxX = Math.max(0, sceneW - cafardW - margin * 2); const maxY = Math.max(0, sceneH - cafardH - margin * 2); this.x = margin + Math.random() * maxX; this.y = margin + Math.random() * maxY; }, waitVisible(ms) { return new Promise(resolve => { const timer = setTimeout(() => { this.clickResolver = null; resolve("timeout"); }, ms); this.clickResolver = () => { clearTimeout(timer); this.clickResolver = null; resolve("click"); }; }); }, explode() { if (!this.HTMLelement) return; if (this.isExploding) return; this.isExploding = true; if (this.clickResolver) this.clickResolver(); this.HTMLelement.classList.add("explode"); NbExplosions++; elNbExp.textContent = String(NbExplosions); setTimeout(() => { this.disappear(); this.HTMLelement.classList.remove("explode"); this.isExploding = false; }, 400); } }; return target; }  async function targetLoop(target, nbTests, level) { NbApparition = 0; NbExplosions = 0; elNbApp.textContent = "0"; elNbExp.textContent = "0"; for (let i = 0; i < nbTests; i++) { const timeAppear = 5000 / level; target.render(); target.randomPosition(); target.render(); NbApparition++; elNbApp.textContent = String(NbApparition); const result = await target.waitVisible(timeAppear); if (result === "timeout") { target.disappear(); } await sleep(800); } return NbApparition ? (NbExplosions / NbApparition) * 100 : 0; }  async function gameLoop(target) { while (true) { spanLevel.textContent = String(Niveau); const percent = await targetLoop(target, 10, Niveau); target.disappear(); if (percent < 80) { const restart = confirm("Perdu\n" + "Niveau atteint : " + Niveau + "\n" + "Réussite : " + percent.toFixed(0) + "%\n\n" + "Recommencer ?"); if (restart) location.reload(); break; } showPanel("Niveau " + Niveau + " réussi !\n" + "Réussite : " + percent.toFixed(0) + " %\n\n" + "Clique sur Continuer.", true); await waitContinueClick(); Niveau++; } }  btnStart.addEventListener("click", async () => { hide(nouvellePartie); show(scene); show(scores); await sleep(2000); const target = addTarget({ posX: 100, posY: 100 }); gameLoop(target); }); }); document.addEventListener("DOMContentLoaded", () => {  const scene = document.querySelector("#sceneJeu");  const scores = document.querySelector("#scores");  const nouvellePartie = document.querySelector("#nouvellePartie");  const btnStart = nouvellePartie.querySelector("button");  const elNbApp = document.querySelector("#NbApparitions");  const elNbExp = document.querySelector("#NbExplosions");  const overlay = document.querySelector("#overlay");  const panelText = document.querySelector("#panelText");  const btnContinue = document.querySelector("#btnContinue");  const spanLevel = document.querySelector("#level");  let NbApparition = 0;  let NbExplosions = 0;  let Niveau = 1;  function show(el) { el.hidden = false; }  function hide(el) { el.hidden = true; }  show(nouvellePartie);  hide(scene);  hide(scores);  overlay.classList.add("hidden");  elNbApp.textContent = "0";  elNbExp.textContent = "0";  spanLevel.textContent = "1";  function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }  function showPanel(message, showButton = true) { panelText.textContent = message; if (showButton) { btnContinue.style.display = "inline-block"; } else { btnContinue.style.display = "none"; } overlay.classList.remove("hidden"); }  function hidePanel() { overlay.classList.add("hidden"); }  function waitContinueClick() { return new Promise(resolve => { btnContinue.addEventListener("click", () => { hidePanel(); resolve(); }, { once: true }); }); }  function addTarget({ posX, posY }) { const target = { x: posX, y: posY, HTMLelement: null, isExploding: false, clickResolver: null, disappear() { if (this.HTMLelement) this.HTMLelement.style.display = "none"; }, render() { if (this.HTMLelement === null) { this.HTMLelement = document.createElement("div"); this.HTMLelement.className = "target"; scene.append(this.HTMLelement); this.HTMLelement.addEventListener("click", () => this.explode()); } this.HTMLelement.style.display = "block"; this.HTMLelement.style.position = "absolute"; this.HTMLelement.style.top = this.y + "px"; this.HTMLelement.style.left = this.x + "px"; this.HTMLelement.classList.remove("appear"); void this.HTMLelement.offsetWidth; this.HTMLelement.classList.add("appear"); }, randomPosition() { const sceneW = scene.clientWidth; const sceneH = scene.clientHeight; const cafardW = 60; const cafardH = 60; const margin = 10; const maxX = Math.max(0, sceneW - cafardW - margin * 2); const maxY = Math.max(0, sceneH - cafardH - margin * 2); this.x = margin + Math.random() * maxX; this.y = margin + Math.random() * maxY; }, waitVisible(ms) { return new Promise(resolve => { const timer = setTimeout(() => { this.clickResolver = null; resolve("timeout"); }, ms); this.clickResolver = () => { clearTimeout(timer); this.clickResolver = null; resolve("click"); }; }); }, explode() { if (!this.HTMLelement) return; if (this.isExploding) return; this.isExploding = true; if (this.clickResolver) this.clickResolver(); this.HTMLelement.classList.add("explode"); NbExplosions++; elNbExp.textContent = String(NbExplosions); setTimeout(() => { this.disappear(); this.HTMLelement.classList.remove("explode"); this.isExploding = false; }, 400); } }; return target; }  async function targetLoop(target, nbTests, level) { NbApparition = 0; NbExplosions = 0; elNbApp.textContent = "0"; elNbExp.textContent = "0"; for (let i = 0; i < nbTests; i++) { const timeAppear = 5000 / level; target.render(); target.randomPosition(); target.render(); NbApparition++; elNbApp.textContent = String(NbApparition); const result = await target.waitVisible(timeAppear); if (result === "timeout") { target.disappear(); } await sleep(800); } return NbApparition ? (NbExplosions / NbApparition) * 100 : 0; }  async function gameLoop(target) { while (true) { spanLevel.textContent = String(Niveau); const percent = await targetLoop(target, 10, Niveau); target.disappear(); if (percent < 80) { const restart = confirm("Perdu\n" + "Niveau atteint : " + Niveau + "\n" + "Réussite : " + percent.toFixed(0) + "%\n\n" + "Recommencer ?"); if (restart) location.reload(); break; } showPanel("Niveau " + Niveau + " réussi !\n" + "Réussite : " + percent.toFixed(0) + " %\n\n" + "Clique sur Continuer.", true); await waitContinueClick(); Niveau++; } }  btnStart.addEventListener("click", async () => { hide(nouvellePartie); show(scene); show(scores); await sleep(2000); const target = addTarget({ posX: 100, posY: 100 }); gameLoop(target); }); });</p>
	</div>

	<!-- ! OVERLAY DE FIN DE NIVEAU -->
	<div id="overlay" class="hidden">
		<div id="panel">
			<p id="panelText"></p> <!-- Le texte sera affiché ici -->
			<button id="btnContinue">Continuer</button>
		</div>
	</div>

	<!-- ! EXECUTION DU SCRIPT JS -->
	<script src="script.js"></script>
</body>
</html>